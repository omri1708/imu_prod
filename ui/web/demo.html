<!-- imu_repo/ui/web/demo.html -->
<!doctype html>
<html lang="en">
<meta charset="utf-8"/>
<title>IMU Realtime UI (Push)</title>
<style>
  body { font-family: system-ui, sans-serif; margin: 16px; display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
  .panel { border:1px solid #ddd; padding:12px; }
  .tbl { border-collapse: collapse; width: 100%; }
  .tbl th, .tbl td { border: 1px solid #ddd; padding: 6px 8px; }
  .tbl th { background: #f5f7fb; cursor: pointer; }
  #logs { height: 200px; overflow:auto; background:#0b0f14; color:#cde; font-family: ui-monospace,Menlo,Consolas,monospace; padding:8px; }
  .log.INFO { color:#8f8; } .log.WARN{color:#ff8;} .log.ERROR{color:#f88;}
  canvas { width: 100%; height: 160px; }
</style>

<div class="panel">
  <h3>Orders</h3>
  <div id="orders_table"></div>
</div>
<div class="panel">
  <h3>QPS</h3>
  <div id="qps_metric"></div>
  <h3>Latency</h3>
  <div id="latency_chart"></div>
</div>
<div class="panel" style="grid-column:1 / span 2">
  <h3>Logs</h3>
  <div id="logs"></div>
</div>

<script src="./client_widget.js"></script>
<script>
  const table = new IMUClient.TableWidget("orders_table","id");
  const metric = new IMUClient.MetricWidget("qps_metric");
  const chart  = new IMUClient.ChartWidget("latency_chart");
  const logs   = new IMUClient.LogWidget("logs");

  const ws = IMUClient.connectWS("ws://127.0.0.1:9402/", {
    minSources: 1, minTrust: 1.0,
    onMsg: (doc)=>{
      const ui = doc.bundle.ui || {};
      if(ui.orders_table) table.apply(ui.orders_table);
      if(ui.qps_metric)   metric.apply(ui.qps_metric);
      if(ui.latency_chart) chart.apply(ui.latency_chart);
      if(ui.logs_panel)   logs.apply(ui.logs_panel);
    }
  });
</script>
</html>